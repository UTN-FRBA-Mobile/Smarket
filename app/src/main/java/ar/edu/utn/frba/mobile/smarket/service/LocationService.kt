package ar.edu.utn.frba.mobile.smarket.service

import ar.edu.utn.frba.mobile.smarket.model.Location
import com.google.firebase.firestore.CollectionReference
import com.google.firebase.firestore.FirebaseFirestore
import com.google.firebase.firestore.QueryDocumentSnapshot
import com.google.gson.Gson
import kotlin.collections.ArrayList
import kotlin.collections.HashMap

object LocationService {

    private fun getInstance(): CollectionReference {
        return FirebaseFirestore.getInstance().collection("locations")
    }

    fun getLocations(): List<Location> {
        var jsonString = """[{"id":1045,"description":"25 de Mayo"},{"id":36,"description":"3 de Febrero"},{"id":1021,"description":"9 de Julio"},{"id":1047,"description":"Albardón"},{"id":134,"description":"Almirante Brown"},{"id":443,"description":"Alta Gracia"},{"id":1134,"description":"América"},{"id":1090,"description":"Anisacate"},{"id":857,"description":"Apolinario Saravia"},{"id":1170,"description":"Apóstoles"},{"id":128,"description":"Avellaneda"},{"id":1129,"description":"Avellaneda (Santa Fe)"},{"id":809,"description":"Azul"},{"id":119,"description":"Bahía Blanca"},{"id":1171,"description":"Balcarce"},{"id":637,"description":"Baradero"},{"id":1061,"description":"Bariloche"},{"id":1095,"description":"Barranqueras"},{"id":1135,"description":"Basavilbaso"},{"id":163,"description":"Bell Ville"},{"id":952,"description":"Bella Vista"},{"id":142,"description":"Berazategui"},{"id":644,"description":"Berisso"},{"id":855,"description":"Cafayate"},{"id":146,"description":"Campana"},{"id":1051,"description":"Campo Quijano"},{"id":786,"description":"Cañuelas"},{"id":936,"description":"Capilla del Monte"},{"id":760,"description":"Capilla del Señor"},{"id":3,"description":"Capital Federal"},{"id":821,"description":"Capitán Bermúdez"},{"id":1175,"description":"Carmen de Patagones"},{"id":860,"description":"Caucete"},{"id":1028,"description":"Centenario"},{"id":854,"description":"Cerrillos"},{"id":833,"description":"Chacabuco"},{"id":1136,"description":"Chajarí"},{"id":1142,"description":"Chascomús"},{"id":836,"description":"Chilecito"},{"id":783,"description":"Chivilcoy"},{"id":1062,"description":"Cinco Saltos"},{"id":943,"description":"Cipolletti"},{"id":442,"description":"Colón"},{"id":673,"description":"Colonia Caroya"},{"id":651,"description":"Comodoro Rivadavia"},{"id":1066,"description":"Concepción"},{"id":620,"description":"Concepción del Uruguay"},{"id":542,"description":"Concordia"},{"id":1137,"description":"Conscripto Bernardi"},{"id":137,"description":"Córdoba"},{"id":701,"description":"Coronda"},{"id":1169,"description":"Coronel Dorrego"},{"id":1092,"description":"Coronel Pringles"},{"id":757,"description":"Coronel Suárez"},{"id":957,"description":"Corral de Bustos"},{"id":564,"description":"Corrientes"},{"id":657,"description":"Cosquín"},{"id":1065,"description":"Crespo"},{"id":1097,"description":"Cruz Alta"},{"id":164,"description":"Cruz del Eje"},{"id":1070,"description":"El Calafate"},{"id":845,"description":"Eldorado"},{"id":151,"description":"Escobar"},{"id":889,"description":"Esperanza"},{"id":1131,"description":"Esquel"},{"id":40,"description":"Esteban Echeverría"},{"id":372,"description":"Exaltación de la Cruz"},{"id":685,"description":"Ezeiza"},{"id":1067,"description":"Famaillá"},{"id":1079,"description":"Firmat"},{"id":614,"description":"Florencio Varela"},{"id":1139,"description":"Florentino Ameghino"},{"id":1093,"description":"Formosa"},{"id":856,"description":"Fraile Pintado"},{"id":822,"description":"Fray Luis Beltrán"},{"id":1053,"description":"Fray Mamerto Esquiú"},{"id":722,"description":"Freyre"},{"id":341,"description":"Funes"},{"id":942,"description":"Gálvez"},{"id":586,"description":"General Alvear"},{"id":1026,"description":"General Güemes"},{"id":838,"description":"General Juan Madariaga"},{"id":1022,"description":"General Paz"},{"id":1078,"description":"General Pico"},{"id":844,"description":"General Roca"},{"id":124,"description":"General Rodríguez"},{"id":172,"description":"Godoy Cruz"},{"id":954,"description":"Goya"},{"id":1038,"description":"Gral. José de San Martín"},{"id":813,"description":"Granadero Baigorria"},{"id":934,"description":"Gualeguay"},{"id":622,"description":"Gualeguaychú"},{"id":173,"description":"Guaymallén"},{"id":837,"description":"Guiñazú"},{"id":116,"description":"Hurlingham"},{"id":1148,"description":"Itatí"},{"id":45,"description":"Ituzaingó"},{"id":955,"description":"Ituzaingó - Corrientes"},{"id":1064,"description":"Jardín America"},{"id":162,"description":"Jesus María"},{"id":853,"description":"Joaquin V. González"},{"id":49,"description":"José C Paz"},{"id":1032,"description":"Juan José Castelli"},{"id":865,"description":"Junín"},{"id":873,"description":"Justiniano Posse"},{"id":484,"description":"Justo Daract"},{"id":1039,"description":"La Banda"},{"id":1091,"description":"La Bolsa"},{"id":161,"description":"La Calera"},{"id":763,"description":"La Costa"},{"id":582,"description":"La Falda"},{"id":37,"description":"La Matanza"},{"id":1145,"description":"La Paz"},{"id":55,"description":"La Plata"},{"id":1040,"description":"La Punta"},{"id":558,"description":"La Rioja"},{"id":959,"description":"Laguna Paiva"},{"id":62,"description":"Lanús"},{"id":1147,"description":"Las Flores"},{"id":170,"description":"Las Heras"},{"id":1120,"description":"Las Heras - Santa Cruz"},{"id":862,"description":"Las Lajitas"},{"id":871,"description":"Las Talitas"},{"id":965,"description":"Lincoln"},{"id":835,"description":"Lobos"},{"id":74,"description":"Lomas de Zamora"},{"id":271,"description":"Luján"},{"id":174,"description":"Luján de Cuyo"},{"id":171,"description":"Maipú"},{"id":1055,"description":"Makallé"},{"id":879,"description":"Malagueño"},{"id":670,"description":"Malargüe"},{"id":152,"description":"Malvinas Argentinas"},{"id":1116,"description":"Manantial"},{"id":118,"description":"Mar del Plata"},{"id":165,"description":"Marcos Juarez"},{"id":878,"description":"Marcos Paz"},{"id":1149,"description":"Mburucuyá"},{"id":839,"description":"Medrano"},{"id":580,"description":"Mendiolaza"},{"id":169,"description":"Mendoza"},{"id":110,"description":"Mercedes"},{"id":46,"description":"Merlo"},{"id":869,"description":"Merlo - San Luis"},{"id":1029,"description":"Metán"},{"id":508,"description":"Miramar"},{"id":1048,"description":"Monte Quemado"},{"id":1050,"description":"Monteros"},{"id":1044,"description":"Monterrico"},{"id":68,"description":"Moreno"},{"id":38,"description":"Morón"},{"id":1144,"description":"Navarro"},{"id":741,"description":"Necochea"},{"id":1125,"description":"Nelson"},{"id":297,"description":"Neuquén"},{"id":405,"description":"Nogoyá"},{"id":1143,"description":"Oberá"},{"id":566,"description":"Olavarría"},{"id":166,"description":"Oncativo"},{"id":859,"description":"Palpala"},{"id":476,"description":"Paraná"},{"id":956,"description":"Paso de los Libres"},{"id":848,"description":"Pérez"},{"id":1141,"description":"Pergamino"},{"id":754,"description":"Perico"},{"id":140,"description":"Pilar"},{"id":863,"description":"Pilar - Córdoba"},{"id":158,"description":"Pinamar"},{"id":944,"description":"Plottier"},{"id":1071,"description":"Pocito"},{"id":576,"description":"Posadas"},{"id":703,"description":"Presidente Perón"},{"id":814,"description":"Pueblo Esther"},{"id":1154,"description":"Puelén"},{"id":1121,"description":"Puerto Deseado"},{"id":823,"description":"Puerto General San Martín"},{"id":843,"description":"Puerto Iguazú"},{"id":729,"description":"Puerto Madryn"},{"id":721,"description":"Puiggari"},{"id":1080,"description":"Punta Alta"},{"id":1063,"description":"Quebrada de los Pozos"},{"id":50,"description":"Quilmes"},{"id":650,"description":"Rada Tilly"},{"id":602,"description":"Rafaela"},{"id":1155,"description":"Rancul"},{"id":693,"description":"Reconquista"},{"id":574,"description":"Resistencia"},{"id":159,"description":"Río Ceballos"},{"id":382,"description":"Río Cuarto"},{"id":572,"description":"Río Gallegos"},{"id":958,"description":"Rio Grande"},{"id":834,"description":"Río Primero"},{"id":1073,"description":"Rio Seco"},{"id":964,"description":"Río Segundo"},{"id":655,"description":"Río Tercero"},{"id":816,"description":"Rivadavia"},{"id":820,"description":"Rivadavia de San Juan"},{"id":1172,"description":"Rojas"},{"id":801,"description":"Roldán"},{"id":72,"description":"Rosario"},{"id":864,"description":"Rosario de Lerma"},{"id":1057,"description":"Sáenz Peña"},{"id":1020,"description":"Saladillo"},{"id":1146,"description":"Salliqueló"},{"id":404,"description":"Salta"},{"id":939,"description":"San Carlos"},{"id":1138,"description":"San Cristóbal"},{"id":156,"description":"San Fernando"},{"id":842,"description":"San Fernando del Valle de Catamarca"},{"id":396,"description":"San Francisco"},{"id":26,"description":"San Isidro"},{"id":817,"description":"San Juan"},{"id":371,"description":"San Lorenzo"},{"id":407,"description":"San Luis"},{"id":71,"description":"San Martín"},{"id":550,"description":"San Martín de los Andes"},{"id":480,"description":"San Martín Mendoza"},{"id":51,"description":"San Miguel"},{"id":417,"description":"San Miguel de Tucumán"},{"id":273,"description":"San Miguel del Monte"},{"id":120,"description":"San Nicolás"},{"id":775,"description":"San Patricio del Chañar"},{"id":686,"description":"San Pedro"},{"id":858,"description":"San Pedro de Jujuy"},{"id":370,"description":"San Rafael"},{"id":1027,"description":"San Ramón de la Nueva Oran"},{"id":1173,"description":"San Roque"},{"id":486,"description":"San Salvador de Jujuy"},{"id":77,"description":"San Vicente"},{"id":1140,"description":"Santa Catalina"},{"id":568,"description":"Santa Fe"},{"id":819,"description":"Santa Lucía"},{"id":960,"description":"Santa Lucía de San Juan"},{"id":445,"description":"Santa María de Punilla"},{"id":810,"description":"Santa Rosa"},{"id":384,"description":"Santiago del Estero"},{"id":706,"description":"Santo Tomé"},{"id":1152,"description":"Santo Tome - Corrientes"},{"id":1150,"description":"Sauce"},{"id":1041,"description":"Senillosa"},{"id":852,"description":"Sierra de los Padres"},{"id":951,"description":"Tafí Viejo"},{"id":145,"description":"Tandil"},{"id":1153,"description":"Tapalqué"},{"id":877,"description":"Tartagal"},{"id":44,"description":"Tigre"},{"id":1056,"description":"Tilcara"},{"id":1151,"description":"Tinogasta"},{"id":1098,"description":"Trelew"},{"id":769,"description":"Trenque Lauquen"},{"id":1119,"description":"Tres Arroyos"},{"id":684,"description":"Tristán Suárez"},{"id":560,"description":"Tunuyán"},{"id":102,"description":"Turdera"},{"id":824,"description":"Unquillo"},{"id":570,"description":"Ushuaia"},{"id":861,"description":"Vaqueros"},{"id":1174,"description":"Veinticinco de Mayo"},{"id":27,"description":"Vicente López"},{"id":1094,"description":"Victoria"},{"id":886,"description":"Viedma"},{"id":1069,"description":"Villa Aberastain"},{"id":160,"description":"Villa Allende"},{"id":1052,"description":"Villa Angela"},{"id":441,"description":"Villa Carlos Paz"},{"id":502,"description":"Villa de Merlo"},{"id":846,"description":"Villa General Belgrano"},{"id":815,"description":"Villa Gesell"},{"id":847,"description":"Villa Gobernador Gálvez"},{"id":818,"description":"Villa Krause"},{"id":167,"description":"Villa María"},{"id":472,"description":"Villa Mercedes"},{"id":851,"description":"Villa Nueva"},{"id":1037,"description":"Villa San Isidro"},{"id":1049,"description":"Villa San Martín"},{"id":1105,"description":"Villaguay"},{"id":872,"description":"Yerba Buena"},{"id":272,"description":"Zárate"}]""";
        return Gson().fromJson(jsonString, Array<ar.edu.utn.frba.mobile.smarket.model.Location>::class.java).toList()
/*
        val locations = ArrayList<Location>()
        getInstance().get()
            .addOnCompleteListener { response ->
                if (response.isSuccessful) {
                    response.result!!.filterNotNull()
                        .forEach {
                            locations.addAll(transform(it))
                        }
                } else
                    throw RuntimeException("Error al conectarse con la base de datos")
            }
        return locations*/
    }

    private fun transform(query: QueryDocumentSnapshot): List<Location> {
        val data = query.data
        val products = data["products"] as List<HashMap<String, Any>>
        return products.map {
            Location(
                it["id"] as Long,
                it["description"] as String
            )
        }
    }
}